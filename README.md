# $C^3P$:Confusion-Guided Conformal Predictionwith Class Clustering for Compact Sets

本文提出了一种名为$C^3P$的新型分形预测框架，旨在解决传统方法在长尾分布场景下预测集过大且计算效率低的问题。核心挑战在于：当类别数量庞大且校准数据有限时，传统类条件分形预测会导致稀有类别覆盖不稳定，同时预测集规模膨胀。C3P通过双重创新机制实现突破：
1）基于混淆矩阵的预过滤机制，利用历史误分类模式快速剔除低概率类别；
2）自动贝叶斯聚类方法，通过Dirichlet过程混合模型将具有相似不确定性分布的类别归为同一簇，共享校准数据。该方法在保证有限样本覆盖的前提下，将预测阶段复杂度从O(K log K)降至O(|S|)，其中|S|为混淆支持集大小，通常远小于总类别数。
实验表明，C3P在CIFAR-100、iNaturalist等数据集上显著优于RC3P和Cluster CP，在保持90%置信水平的同时，预测集平均规模降低至原有方法的1/10-1/5，且对长尾类别覆盖稳定性提升超10%。理论分析证明其满足边际覆盖保证，时间复杂度分析显示校准阶段与现有方法相当，但预测阶段效率提升1-2个数量级，特别适用于实时部署场景。
